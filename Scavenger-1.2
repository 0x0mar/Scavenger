#!/usr/bin/python
#Author: Jared Stroud

#Dependencies:
from shodan import WebAPI  #shodan API requirements
import ExploitDB

SHODAN_API_KEY = "" #Enter API key here
api = WebAPI(SHODAN_API_KEY)

#Function Menu
#Purpose: displaying a menu of options
def menu(): #menu display
	
	print """
		1)Search Exploit-db  
		2)Search Shodan
		3)Search Host Location By IP
		4)WhoIs search
       	"""

def menuOpt(): #submenu opt
        
	usrIn = raw_input("\n Enter option: ")
        if (usrIn == "1"):   
		ExploitDB.srchExploitDB()
		menu()
        elif(usrIn == "2"):
	        srchShodan()
		menu()	
	elif(usrIn == "3"):
		shodanHost()
		menu()
	elif(usrIn == "4"):
		ExploitDB.whoisSrch()
		menu()

def srchShodan():
	
	print """\n Popular search terms:
			- scada
			- http
			- webcam
			- cisco
			- login
			- anonymous
			- ssh
			- telnet
			- default
			- port #
			- no
	"""
	shosearch = raw_input("\n Enter term to search: ")
	results = api.search(shosearch) #searching based on users preset terms
	print (shosearch, 'resulted in %s results' % results ['total'])
	
	for result in results ['matches']:
		print 'IP: %s' % result['ip'] #printing searches API
		print result['data'] #Printing informaton from banners
		print ''

#Name: shodanHost
#Function: searches IP address, country info, banners, ports etc...
def shodanHost():

	ip = raw_input("Enter host IP: ")
	host = api.host(ip) #looks up geo location (sometimes will throw back "none" if nothing is recorded in database"
	
	print """ 
		IP: %s
		Country: %s
		City: %s
   		""" %(host['ip'], host.get('country', None), host.get('city',None)) #Printing geo location
	

#############start of main############
menu()
while(1): #continuously prompt for menu option
	menuOpt()
	
